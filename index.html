<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>OMLLA BOT | OFFICIAL GOLD</title>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; user-select: none; -webkit-tap-highlight-color: transparent; }
        :root {
            --primary-gold: #FFD700;
            --gold-gradient: linear-gradient(135deg, #bf953f, #fcf6ba, #b38728, #fbf5b7, #aa771c);
            --dark: #050505;
            --dark-light: #0f0f0f;
            --gray: #1a1a1a;
            --text-gray: #888;
            --emerald: #14F195;
        }

        body {
            background: var(--dark);
            color: white;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            height: 100vh;
            overflow: hidden;
            display: flex;
            justify-content: center;
        }

        .container {
            width: 100%;
            max-width: 400px;
            padding: 20px;
            height: 100vh;
            display: flex;
            flex-direction: column;
            background: radial-gradient(circle at top, #1a1a0a 0%, #050505 100%);
            overflow-y: auto;
            padding-bottom: 90px; /* ŸÖÿ≥ÿßÿ≠ÿ© ŸÑŸÑÿ™ŸÜŸÇŸÑ ÿßŸÑÿ≥ŸÅŸÑŸä */
        }

        /* Branding & Timer */
        .brand { font-size: 10px; letter-spacing: 5px; color: var(--primary-gold); text-align: center; margin-bottom: 12px; font-weight: 900; }
        
        .timer-card {
            background: var(--gold-gradient);
            border-radius: 18px;
            padding: 12px 18px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 12px;
            color: #4a3505;
            box-shadow: 0 5px 15px rgba(0,0,0,0.4);
        }

        .balance-card {
            background: var(--dark-light);
            border-radius: 25px;
            padding: 20px;
            border: 1px solid rgba(255,215,0,0.2);
            text-align: center;
            margin-bottom: 15px;
        }
        .balance-amount {
            font-size: 52px;
            font-weight: 900;
            color: var(--primary-gold);
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }

        /* Pages Control */
        .page { display: none; animation: fadeIn 0.4s ease; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Tap Engine */
        .tap-area { text-align: center; margin: 20px 0; }
        .gold-coin {
            width: 220px; height: 220px;
            margin: 0 auto;
            border-radius: 50%;
            background: var(--gold-gradient);
            border: 6px solid #8a6d3b;
            display: flex; justify-content: center; align-items: center;
            cursor: pointer;
            box-shadow: 0 0 50px rgba(186, 141, 10, 0.2);
            transition: transform 0.05s ease;
        }
        .gold-coin:active { transform: scale(0.92); }
        .coin-text { font-size: 40px; font-weight: 900; color: #4a3505; letter-spacing: -1px; }

        /* Stats & Grid */
        .stats-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 15px; }
        .stat-card { background: var(--dark-light); border: 1px solid var(--gray); border-radius: 18px; padding: 12px; text-align: center; }
        .stat-value { font-size: 18px; font-weight: 800; color: var(--primary-gold); }
        .stat-label { font-size: 10px; color: var(--text-gray); text-transform: uppercase; }

        /* Navigation */
        .bottom-nav {
            position: fixed; bottom: 0; left: 0; width: 100%;
            display: flex; background: rgba(15,15,15,0.98);
            backdrop-filter: blur(15px); border-top: 1px solid #222;
            padding: 12px 0; z-index: 1000;
        }
        .nav-item { flex: 1; text-align: center; color: #555; transition: 0.3s; cursor: pointer; }
        .nav-item.active { color: var(--primary-gold); }
        .nav-item i { font-size: 20px; display: block; margin-bottom: 4px; }
        .nav-item span { font-size: 10px; font-weight: bold; }

        /* Utilities */
        .btn-gold { background: var(--primary-gold); color: black; border: none; padding: 12px 20px; border-radius: 15px; font-weight: 800; cursor: pointer; width: 100%; margin-top: 10px; }
        .tap-effect { position: absolute; color: var(--primary-gold); font-weight: 900; font-size: 32px; animation: tapFloat 0.8s forwards; pointer-events: none; z-index: 2000; }
        @keyframes tapFloat { 0% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-120px); } }
        
        .energy-bar-bg { height: 10px; background: #111; border-radius: 10px; overflow: hidden; margin: 10px 0; border: 1px solid #222; }
        .energy-bar-fill { height: 100%; background: var(--primary-gold); width: 100%; transition: width 0.3s linear; }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <div class="brand">OMLLA CAPITAL ‚Ä¢ PRESTIGE</div>
            
            <div class="timer-card">
                <i class="fas fa-clock"></i>
                <div style="flex:1">
                    <div style="font-size: 9px; font-weight: 800; text-transform: uppercase;">Time to Global Listing</div>
                    <div id="countdown" style="font-size: 18px; font-weight: 900;">Calculating...</div>
                </div>
                <div style="background: rgba(0,0,0,0.2); padding: 4px 10px; border-radius: 10px; font-size: 12px; font-weight: 800;">LIVE</div>
            </div>

            <div class="balance-card">
                <div class="balance-amount" id="balance-display">0</div>
                <div style="font-size: 11px; color: var(--text-gray); font-weight: 800; letter-spacing: 2px;">O$ GOLD CAPITAL</div>
            </div>
        </header>

        <div id="home-page" class="page active">
            <div class="stats-grid">
                <div class="stat-card"><div class="stat-label">Energy</div><div class="stat-value" id="energy-val">1000</div></div>
                <div class="stat-card"><div class="stat-label">Taps</div><div class="stat-value" id="taps-val">0</div></div>
                <div class="stat-card"><div class="stat-label">Rank</div><div class="stat-value" id="rank-val">#--</div></div>
            </div>

            <div class="tap-area">
                <div class="gold-coin" id="tap-trigger">
                    <div class="coin-text">OMLLA</div>
                </div>
            </div>

            <div class="energy-bar-bg">
                <div class="energy-bar-fill" id="energy-fill"></div>
            </div>
            
            <div style="display:flex; gap:10px;">
                <button class="btn-gold" style="background:#1a1a1a; color:var(--primary-gold); border:1px solid var(--primary-gold)" onclick="copyReferral()"><i class="fas fa-user-plus"></i> INVITE</button>
                <button class="btn-gold" onclick="tg.showAlert('Booster Activated!')"><i class="fas fa-rocket"></i> BOOST</button>
            </div>
        </div>

        <div id="rating-page" class="page">
            <h2 style="color:var(--primary-gold); margin-bottom:15px; text-align:center;">GLOBAL LEADERBOARD</h2>
            <div id="leaderboard-list"></div>
        </div>

        <div id="profile-page" class="page">
            <div class="balance-card" style="text-align: left;">
                <h3 id="prof-name">Elite Player</h3>
                <p id="prof-id" style="font-size: 12px; color: #555;"></p>
                <hr style="margin:15px 0; border:0; border-top:1px solid #222;">
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
                    <div><small>TOTAL TAPS</small><h4 id="prof-taps">0</h4></div>
                    <div><small>REFERRALS</small><h4 id="prof-refs">0</h4></div>
                </div>
            </div>
            <button class="btn-gold" style="background:#ff4444; color:white" onclick="location.reload()">REFRESH ACCOUNT</button>
        </div>

        <nav class="bottom-nav">
            <div class="nav-item active" onclick="showTab('home', this)"><i class="fas fa-home"></i><span>MINE</span></div>
            <div class="nav-item" onclick="showTab('rating', this)"><i class="fas fa-trophy"></i><span>TOP</span></div>
            <div class="nav-item" onclick="showTab('profile', this)"><i class="fas fa-user"></i><span>PROFILE</span></div>
        </nav>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        // üî¥ CONFIGURATION
        const firebaseConfig = { databaseURL: "https://omlla-game-default-rtdb.firebaseio.com" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        const user = tg.initDataUnsafe?.user || { id: 'test_dev', first_name: 'Master' };
        const userRef = db.ref('players/' + user.id);

        let player = { points: 0, energy: 1000, totalTaps: 0, referrals: 0 };

        // UI SYNC
        function updateUI() {
            document.getElementById('balance-display').innerText = Math.floor(player.points).toLocaleString();
            document.getElementById('energy-val').innerText = player.energy;
            document.getElementById('energy-fill').style.width = (player.energy / 10) + "%";
            document.getElementById('taps-val').innerText = player.totalTaps.toLocaleString();
            document.getElementById('prof-taps').innerText = player.totalTaps;
            document.getElementById('prof-refs').innerText = player.referrals;
            document.getElementById('prof-name').innerText = user.first_name;
            document.getElementById('prof-id').innerText = "CAPITAL ID: " + user.id;
        }

        // DATABASE LISTEN
        userRef.on('value', (snap) => {
            const data = snap.val();
            if (data) {
                player = { ...player, ...data };
                updateUI();
            } else {
                userRef.set({ points: 0, energy: 1000, totalTaps: 0, referrals: 0, name: user.first_name });
            }
        });

        // TAP LOGIC
        document.getElementById('tap-trigger').addEventListener('touchstart', (e) => {
            e.preventDefault();
            if (player.energy >= 1) {
                player.points += 1;
                player.energy -= 1;
                player.totalTaps += 1;
                updateUI();

                // Animation
                const touch = e.touches[0];
                const p = document.createElement('div');
                p.className = 'tap-effect'; p.innerText = '+1';
                p.style.left = touch.clientX + 'px'; p.style.top = touch.clientY + 'px';
                document.body.appendChild(p);
                setTimeout(() => p.remove(), 800);

                if (tg.HapticFeedback) tg.HapticFeedback.impactOccurred('medium');

                // Sync Database (Satisfaction of Rule: name + points)
                userRef.update({ points: player.points, energy: player.energy, totalTaps: player.totalTaps, name: user.first_name });
            }
        });

        // TABS SYSTEM
        window.showTab = function(id, el) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(id + '-page').classList.add('active');
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            el.classList.add('active');
            if (id === 'rating') loadLeaderboard();
        }

        function loadLeaderboard() {
            db.ref('players').orderByChild('points').limitToLast(10).once('value', (snap) => {
                let html = '';
                const data = [];
                snap.forEach(child => { data.push(child.val()); });
                data.reverse().forEach((p, i) => {
                    html += `<div class="stat-card" style="display:flex; justify-content:space-between; align-items:center;">
                        <span>#${i+1} ${p.name || 'Investor'}</span>
                        <span style="color:var(--primary-gold); font-weight:900;">${Math.floor(p.points).toLocaleString()} O$</span>
                    </div>`;
                });
                document.getElementById('leaderboard-list').innerHTML = html;
            });
        }

        function copyReferral() {
            const link = `https://t.me/OMLLA_Coin_bot?start=${user.id}`;
            navigator.clipboard.writeText(link);
            tg.showAlert("‚úÖ Referral Link Copied!");
        }

        // COUNTDOWN
        setInterval(() => {
            const now = new Date();
            const h = 23 - now.getHours();
            const m = 59 - now.getMinutes();
            document.getElementById('countdown').innerText = `${h}h ${m}m Remaining`;
        }, 1000);

        // ENERGY REGEN
        setInterval(() => {
            if (player.energy < 1000) {
                player.energy += 1;
                updateUI();
                userRef.child('energy').set(player.energy);
            }
        }, 3000);
const BACKEND_URL = "https://omlla-payments-backend.onrender.com";
    </script>
</body>
</html>

