// Firebase Setup
const firebaseConfig = {
    databaseURL: "https://omllagame-default-rtdb.europe-west1.firebasedatabase.app/"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// تحديد هوية المستخدم من تليجرام
const tg = window.Telegram.WebApp;
const uid = tg.initDataUnsafe?.user?.id || "test_user";

// تحميل النقاط من السحابة عند البدء
db.ref('players/' + uid).once('value').then((snapshot) => {
    if (snapshot.exists()) {
        score = snapshot.val().points;
        scoreEl.innerText = score.toLocaleString();
    }
});

// تعديل وظيفة النقر (الموجودة سابقاً) لإرسال البيانات
// أضف هذا السطر داخل وظيفة coinBtn.addEventListener('touchstart', ...)
db.ref('players/' + uid).set({
    name: tg.initDataUnsafe?.user?.first_name || "Unknown",
    points: score,
    last_click: new Date().toISOString()
});
