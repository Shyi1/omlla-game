<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>OMLLA AI | AUTONOMOUS SOVEREIGN</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --p: #00f2ff; --s: #7000ff; --bg: #020617; }
        * { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color:transparent; font-family: 'Inter', sans-serif; }
        body { background: var(--bg); color: #fff; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        
        .ai-header { padding: 20px; background: rgba(0,242,255,0.03); border-bottom: 1px solid #1e293b; text-align: center; }
        .pulse-dot { display: inline-block; width: 6px; height: 6px; background: var(--p); border-radius: 50%; margin-right: 8px; animation: blink 1s infinite; }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.2; } }

        .balance-display { flex: 0.5; display: flex; flex-direction: column; justify-content: center; align-items: center; background: radial-gradient(circle at top, #0f172a 0%, var(--bg) 100%); }
        .bal-val { font-size: 60px; font-weight: 900; background: linear-gradient(to bottom, #fff, var(--p)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        
        .engine-room { flex: 1; display: flex; align-items: center; justify-content: center; position: relative; }
        .ai-core { width: 260px; height: 260px; border-radius: 50%; background: #0f172a; border: 4px solid #1e293b; display: flex; align-items: center; justify-content: center; position: relative; cursor: pointer; transition: 0.1s; z-index: 10; box-shadow: 0 0 40px rgba(0,0,0,0.8); }
        .ai-core:active { transform: scale(0.95); border-color: var(--p); }
        .ai-core i { font-size: 110px; color: var(--p); filter: drop-shadow(0 0 20px var(--p)); }
        .rotate { animation: spin 0.4s linear infinite; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        .floating-profit { position: absolute; color: var(--p); font-weight: 900; animation: rise 0.7s ease-out forwards; pointer-events: none; }
        @keyframes rise { from { transform: translateY(0); opacity: 1; } to { transform: translateY(-100px); opacity: 0; } }

        .control-panel { background: #0f172a; padding: 30px 20px; border-radius: 40px 40px 0 0; border-top: 1px solid #1e293b; }
        .bar-wrap { width: 100%; height: 8px; background: #020617; border-radius: 10px; margin: 15px 0 25px; overflow: hidden; border: 1px solid #1e293b; }
        .bar-fill { height: 100%; background: linear-gradient(90deg, var(--p), var(--s)); transition: width 0.3s; box-shadow: 0 0 10px var(--p); }
        
        .btn-group { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .btn { padding: 18px; border-radius: 15px; border: none; font-weight: 900; font-size: 13px; cursor: pointer; transition: 0.2s; text-transform: uppercase; }
        .btn-glow { background: var(--p); color: #000; grid-column: span 2; }
        .btn-dark { background: #1e293b; color: #fff; }
        .btn:active { transform: scale(0.97); opacity: 0.8; }
    </style>
</head>
<body>

<div class="ai-header">
    <span class="pulse-dot"></span><small style="letter-spacing: 2px;">AI AGENT: AUTONOMOUS DECISION MODE</small>
</div>

<div class="balance-display">
    <div class="bal-val" id="bal">0.0000</div>
    <div style="font-size: 12px; color: #64748b; letter-spacing: 3px;">REALIZED PROFITS (USD)</div>
</div>

<div class="engine-room">
    <div class="ai-core" id="core" onclick="triggerAI(event)">
        <i class="fas fa-microchip" id="chip"></i>
    </div>
</div>

<div class="control-panel">
    <div style="display: flex; justify-content: space-between; font-size: 11px; font-weight: 900; color: #94a3b8;">
        <span>AGENT CORE STABILITY</span>
        <span id="ev">100%</span>
    </div>
    <div class="bar-wrap"><div class="bar-fill" id="eb"></div></div>
    
    <div class="btn-group">
        <button class="btn btn-dark" onclick="upgrade()">Upgrade Agent</button>
        <button class="btn btn-dark" onclick="recharge()">Force Refill</button>
        <button class="btn btn-glow" onclick="cashout()">Execute AI Withdrawal</button>
    </div>
</div>

<script>
    const tg = window.Telegram.WebApp;
    tg.expand();
    
    firebase.initializeApp({ databaseURL: "YOUR_FIREBASE_URL" });
    const db = firebase.database();
    const uid = (tg.initDataUnsafe?.user?.id || "DEV_MODE").toString();

    let balance = 0, energy = 100, lvl = 1;

    // The In-Code Autonomous Logic (The Agent's Brain)
    const AGENT_LOGIC = {
        getProfitRate: () => (0.00025 * lvl) * (energy / 100),
        getDrainRate: () => 0.15 + (lvl * 0.02)
    };

    db.ref('players/' + uid).on('value', (s) => {
        const d = s.val() || { balance: 0, energy: 100, lvl: 1 };
        balance = d.balance; energy = d.energy; lvl = d.lvl;
        updateUI();
    });

    function updateUI() {
        document.getElementById('bal').innerText = balance.toFixed(4);
        document.getElementById('ev').innerText = Math.floor(energy) + "%";
        document.getElementById('eb').style.width = energy + "%";
        if(energy <= 0) document.getElementById('chip').style.opacity = "0.1";
        else document.getElementById('chip').style.opacity = "1";
    }

    function triggerAI(e) {
        if(energy <= 1) { tg.HapticFeedback.notificationOccurred('error'); return; }
        
        const profit = AGENT_LOGIC.getProfitRate();
        balance += profit;
        energy -= AGENT_LOGIC.getDrainRate();
        
        tg.HapticFeedback.impactOccurred('heavy');
        const chip = document.getElementById('chip');
        chip.classList.add('rotate');
        setTimeout(() => chip.classList.remove('rotate'), 400);
        
        spawnEffect(e.pageX, e.pageY, `+$${profit.toFixed(4)}`);
        if(Math.random() > 0.85) sync();
        updateUI();
    }

    function spawnEffect(x, y, txt) {
        const div = document.createElement('div');
        div.className = 'floating-profit';
        div.style.left = x + 'px'; div.style.top = y + 'px';
        div.innerText = txt;
        document.body.appendChild(div);
        setTimeout(() => div.remove(), 700);
    }

    function sync() { db.ref('players/' + uid).update({ balance, energy, lvl }); }

    function recharge() {
        tg.showConfirm("Execute energy recharge for 50 Stars?", ok => {
            if(ok) db.ref('players/'+uid).update({energy: 100});
        });
    }

    function upgrade() {
        tg.showConfirm("Boost AI Intelligence to increase profit multiplier?", ok => {
            if(ok) db.ref('players/'+uid).update({lvl: lvl + 1});
        });
    }

    function cashout() {
        tg.showAlert("AI AUDIT: Minimum payout of $10.00 required for autonomous Ledger execution.");
    }
</script>
</body>
</html>
