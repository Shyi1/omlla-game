<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>OMLLA • JUST PLAY & EARN</title>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --primary: #5d5fef; --secondary: #a5a6f6;
            --bg: #f4f7ff; --text: #1a1a1a; --card: #ffffff;
            --green: #14ca82; --gray: #8e8e93;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background-color: var(--bg); color: var(--text); min-height: 100vh; display: flex; flex-direction: column; align-items: center; }

        .app-shell {
            width: 100%; max-width: 500px; min-height: 100vh; 
            background: var(--bg); position: relative; padding-bottom: 100px;
            box-shadow: 0 0 40px rgba(0,0,0,0.05);
        }

        .header {
            background: var(--primary); color: white; padding: 40px 20px 80px;
            border-bottom-left-radius: 40px; border-bottom-right-radius: 40px;
            text-align: center;
        }

        .wallet-card {
            background: var(--card); width: 85%; border-radius: 25px;
            margin: -50px auto 20px; padding: 25px; text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08); display: flex; justify-content: space-around;
        }

        .stat b { display: block; font-size: 24px; color: var(--primary); font-weight: 800; }
        .stat span { font-size: 11px; color: var(--gray); font-weight: 700; }

        .page { display: none; padding: 20px; animation: fadeIn 0.4s ease; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .offer-row {
            background: var(--card); border-radius: 20px; padding: 15px;
            margin-bottom: 15px; display: flex; align-items: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.02); cursor: pointer;
        }

        .offer-icon { width: 50px; height: 50px; background: #f0f1ff; border-radius: 12px; display: flex; align-items: center; justify-content: center; color: var(--primary); font-size: 22px; margin-right: 15px; }

        .tap-circle {
            width: 180px; height: 180px; border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            margin: 20px auto; display: flex; align-items: center; justify-content: center;
            color: white; font-size: 60px; cursor: pointer; box-shadow: 0 15px 35px rgba(93, 95, 239, 0.4);
        }

        .navbar {
            position: fixed; bottom: 0; width: 100%; max-width: 500px; 
            background: white; display: flex; justify-content: space-around; 
            padding: 15px 0; border-top: 1px solid #eee; z-index: 1000;
        }

        .nav-link { color: #ccc; text-align: center; font-size: 11px; cursor: pointer; font-weight: 700; }
        .nav-link.active { color: var(--primary); }
        .nav-link i { font-size: 20px; display: block; margin-bottom: 5px; }

        input, select { width: 100%; padding: 15px; border-radius: 12px; border: 1px solid #eee; margin-bottom: 12px; background: #f9f9fb; outline: none; }
        .btn-pay { background: var(--primary); color: white; border: none; padding: 16px; border-radius: 12px; font-weight: 700; cursor: pointer; width: 100%; }
    </style>
</head>
<body>

<div class="app-shell">
    <div class="header">
        <h1 style="font-size: 26px;">OMLLA CAPITAL</h1>
        <p style="opacity: 0.8;">Premium Reward Platform</p>
    </div>

    <div class="wallet-card">
        <div class="stat">
            <b id="bal-coins">0</b>
            <span>O$ COINS</span>
        </div>
        <div style="width: 1px; height: 40px; background: #eee;"></div>
        <div class="stat">
            <b id="bal-usd">$0.00</b>
            <span>USD CASH</span>
        </div>
    </div>

    <div id="home" class="page active">
        <div class="tap-circle" id="coin-trigger"><i class="fas fa-hand-holding-usd"></i></div>
        <div style="text-align: center; margin-top: 20px;">
            <p style="font-weight: 700; color: var(--gray);">ENERGY: <span id="energy-num">1000</span>/1000</p>
            <div style="width: 200px; height: 6px; background: #e0e0e0; margin: 10px auto; border-radius: 10px; overflow: hidden;">
                <div id="energy-bar" style="width: 100%; height: 100%; background: var(--primary); transition: 0.3s;"></div>
            </div>
        </div>
    </div>

    <div id="earn" class="page">
        <h2 style="margin-bottom: 15px; font-size: 18px;">Earn Massive Rewards</h2>
        <div class="offer-row" onclick="watchAd()">
            <div class="offer-icon"><i class="fas fa-video"></i></div>
            <div style="flex:1;"><b>Adsterra High-CPM Video</b><br><small style="color:var(--green)">+1,500 Coins</small></div>
            <i class="fas fa-chevron-right" style="color:#eee"></i>
        </div>
        <div class="offer-row" onclick="openMonlix()">
            <div class="offer-icon"><i class="fas fa-tasks"></i></div>
            <div style="flex:1;"><b>Monlix Offerwall</b><br><small style="color:var(--green)">Up to $100.00 Rewards</small></div>
            <i class="fas fa-chevron-right" style="color:#eee"></i>
        </div>
    </div>

    <div id="profile" class="page">
        <h2 style="margin-bottom: 15px; font-size: 18px;">Profile & Cash Out</h2>
        <div style="background: white; padding: 20px; border-radius: 20px;">
            <label style="font-size: 11px; font-weight: 700; color: var(--gray);">PAYPAL EMAIL</label>
            <input type="email" id="user-paypal" placeholder="email@example.com">
            <label style="font-size: 11px; font-weight: 700; color: var(--gray);">SOLANA ADDRESS</label>
            <input type="text" id="user-solana" placeholder="Solana Wallet Address">
            <button class="btn-pay" onclick="saveProfile()">SAVE & WITHDRAW</button>
            <p style="text-align: center; font-size: 10px; color: #aaa; margin-top: 15px;">Minimum Payout: $10.00 • 24h Processing</p>
        </div>
    </div>

    <nav class="navbar">
        <div class="nav-link active" onclick="nav('home', this)"><i class="fas fa-home"></i>Home</div>
        <div class="nav-link" onclick="nav('earn', this)"><i class="fas fa-rocket"></i>Earn</div>
        <div class="nav-link" onclick="nav('profile', this)"><i class="fas fa-user-circle"></i>Profile</div>
    </nav>
</div>

<script>
    const FIREBASE_URL = "https://omllagame-default-rtdb.europe-west1.firebasedatabase.app/";
    const ADSTERRA_LINK = "https://www.effectivegatecpm.com/he8dq7vjm?key=af62b951b6830e28a656fec604663f2f"; 
    const MONLIX_LINK = "https://publisher.monlix.com/apps/20163";

    const tg = window.Telegram.WebApp;
    tg.expand();

    firebase.initializeApp({ databaseURL: FIREBASE_URL });
    const db = firebase.database();
    const user = tg.initDataUnsafe?.user || { id: "WEB_USER_" + Math.floor(Math.random()*999) };
    const userRef = db.ref('players/' + user.id);

    let state = { points: 0, energy: 1000 };

    userRef.on('value', snap => {
        const data = snap.val();
        if (data) {
            state.points = data.points || 0;
            state.energy = data.energy !== undefined ? data.energy : 1000;
            document.getElementById('user-paypal').value = data.paypal || "";
            document.getElementById('user-solana').value = data.solana || "";
            updateUI();
        } else { userRef.set({ points: 0, energy: 1000 }); }
    });

    function updateUI() {
        document.getElementById('bal-coins').innerText = Math.floor(state.points).toLocaleString();
        document.getElementById('bal-usd').innerText = "$" + (state.points / 10000).toFixed(2);
        document.getElementById('energy-num').innerText = state.energy;
        document.getElementById('energy-bar').style.width = (state.energy / 10) + "%";
    }

    document.getElementById('coin-trigger').onclick = () => {
        if (state.energy > 0) {
            state.points += 2; state.energy--;
            userRef.update({ points: state.points, energy: state.energy });
            if(tg.HapticFeedback) tg.HapticFeedback.impactOccurred('medium');
        } else { tg.showAlert("Energy empty! Use the Earn tab to refill."); }
    };

    function nav(p, el) {
        document.querySelectorAll('.page').forEach(x => x.classList.remove('active'));
        document.getElementById(p).classList.add('active');
        document.querySelectorAll('.nav-link').forEach(x => x.classList.remove('active'));
        el.classList.add('active');
    }

    function saveProfile() {
        const paypal = document.getElementById('user-paypal').value;
        const solana = document.getElementById('user-solana').value;
        const usd = (state.points / 10000);
        userRef.update({ paypal, solana });
        if(usd >= 10) { tg.showAlert("Withdrawal request for $" + usd.toFixed(2) + " submitted!"); }
        else { tg.showAlert("Profile saved. Minimum cashout is $10.00."); }
    }

    function watchAd() {
        tg.openLink(ADSTERRA_LINK);
        tg.showConfirm("Claim 1,500 Coins after viewing?", (ok) => {
            if(ok) userRef.child('points').transaction(p => (p || 0) + 1500);
        });
    }

    function openMonlix() { tg.openLink(MONLIX_LINK); }

    setInterval(() => {
        if(state.energy < 1000) { state.energy++; userRef.child('energy').set(state.energy); }
    }, 5000);
</script>
</body>
</html>
